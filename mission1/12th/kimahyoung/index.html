<html>

<head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
</head>

<body>
    <div id="todo-list"></div>
    <div id="program-list"></div>
    <div id="exercise-list"></div>

    <script>
        const data = [{
            text: 'JS 공부하기',
            isCompleted: false
        }, {
            text: 'JS 복습하기',
            isCompleted: false
        }]

        const program = [{
            text: 'JS 스터디 과제하기',
            isCompleted: true
        }, {
            text: 'vue로 날씨 앱 만들기',
            isCompleted: false
        }]

        const exercise = [{
            text: '산책하기',
            isCompleted: true
        }, {
            text: '스트레칭하기',
            isCompleted: false
        }]

        const next = [{
            text: '일찍 자기',
            isCompleted: false
        }, {
            text: '일찍 일어나기',
            isCompleted: false
        }]

        function TodoList(data, name) {
            this.setState = function(nextData) {
                loadTodoList(nextData, name)
            }


            const loadTodoList = (data, name) => {
                this.data = data;

                this.dataCheck = function() {
                    if (!Array.isArray(data)) {
                        throw new Error('배열이 아닙니다')
                    }
                    if (!(this instanceof TodoList)) {
                        throw new Error('new 키워드 안 붙이면 에러 발생')
                    }
                }

                this.dataCheck()

                this.todo = function() {
                    return this.data.map(({
                            text,
                            isCompleted
                        }) =>
                        isCompleted ? `<div><s>${text}</s></div>` : `<div>${text}</div>`).join('')
                }
                this.render = function() {
                    document.querySelector(`#${name}`).innerHTML = this.todo()
                }
                this.render()
            }

            loadTodoList(data, name)

            // this.setState = function(nextData) {
            //     this.data = nextData
            //     this.dataCheck(nextData)
            //     this.render()
            // }

        }

        var todoList = new TodoList(data, 'todo-list');
        var programList = new TodoList(program, 'program-list');
        var exerciseList = new TodoList(exercise, 'exercise-list');
        todoList.setState(next);
    </script>
</body>

</html>