<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list1"></div>
    <div id="todo-list2"></div>
    <div id="todo-list3"></div>
    <script>
      const data1 = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: false,
        },
      ]

      const data2 = [
        {
          text: '어깨운동',
          isCompleted: true,
        },
        {
          text: '등운동',
          isCompleted: false,
        },
      ]

      const data3 = [
        {
          text: '방청소',
          isCompleted: true,
        },
        {
          text: '부엌 청소',
          isCompleted: false,
        },
      ]

      // 필수 요구사항 구현
      // 가급적 es5 스펙으로 작성(템플릿 리터럴 제외)
      function TodoList(data, num) {

        validationData(data);

        this.data = data;
        // 다중 컴포넌트에 따른 구현
        this.targetNum = document.querySelector(`#todo-list${num}`);

        this.render = function() {
          // template literals로 결합한 내용도 문자열 형태로 리턴되는 값이기에 map 으로 돌릴 경우 쉼표를 반환한다. 그래서 .join('')을 사용
          // isCompleted에 따른 처리 구현
          this.targetNum.innerHTML = this.data.map(todo => todo.isCompleted ?  `<div><s>${todo.text}</s></div>` : `<div>${todo.text}</div>`).join('')
        }

        //setState 구현
        this.setState = function(nextData) {
          validationData(nextData);
          this.data = nextData;
          this.render();
        }

        function validationData (data) {
          if(!data) {
            throw new Error('data 값이 비어 있습니다.');
          }

          if (!Array.isArray(data)) {
            throw new Error('파라미터가 배열이 아닙니다.');
          }

          data.forEach((item) => {
            if (!item.hasOwnProperty('text') || !item.hasOwnProperty('isCompleted')) {
              throw new Error('넘어온 파라미터 속성이 올바르지 않습니다.');
            }
            
            if (!(typeof item.text === 'string') || !(typeof item.isCompleted === 'boolean')) {
              throw new Error('넘어온 파라미터 자료형이 올바르지 않습니다.');
            }
          })

          if (!new.target) {
            throw new Error('new 키워드를 사용하지 않았습니다.');
          }
        }
      }
    
      try {
        var todoList = new TodoList(data1, 1);
        todoList.setState(data1);

        var todoList2 = new TodoList(data2, 2);
        todoList2.setState(data2);

        var todoList3 = new TodoList(data3, 3);
        todoList3.setState(data3);
        
      } catch (e) {
        console.log(e)
      }

    </script>
  </body>
</html>
