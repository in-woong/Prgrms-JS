<html>

<head>
  <title>Mission 1</title>
  <meta charset="utf-8" />
</head>

<body>
  <ul id="todo-list-1"></ul>
  <ul id="todo-list-2"></ul>
  <ul id="todo-list-3"></ul>

  <script>
    const data = [
      {
        text: 'JS ê³µë¶€í•˜ê¸°',
        isCompleted: true,
      },
      {
        text: 'JS ë³µìŠµí•˜ê¸°',
        isCompleted: true,
      },
      {
        text: 'TODO ë¦¬ìŠ¤íŠ¸ ë§Œë“¤ê¸°',
        isCompleted: false,
      },
    ]
  
    const data2 = [
      {
        text: 'ìƒˆ ë¸”ë¡œê·¸ ì‘ì„±í•˜ê¸°',
        isCompleted: false,
      },
      {
        text: 'ì»¤í”¼ ë‚´ë ¤ë§ˆì‹œê¸°',
        isCompleted: true,
      },
      {
        text: 'íœ´ê°€ ì¦ê¸°ê¸°',
        isCompleted: true,
      },
    ]

    const data3 = [
      {
        text: 'ë…¸ëŠ”ê²Œ ì œì¼ ì¢‹ì•„',
        isCompleted: false,
      },
      {
        text: 'ë–¡ë³¶ì´ê°€ ì œì¼ ì¢‹ì•„',
        isCompleted: true,
      },
      {
        text: 'ì–´ëŠë§ ê²¨ìš¸ì´ë‹¤',
        isCompleted: false,
      },
    ]
	
  function TodoList(data, id){
    this.data = data;

    if(!(this instanceof TodoList)) throw new Error('new í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ í˜¸ì¶œí•´ì£¼ì„¸ìš”!')

    function checkData(data){
      if(data === null || data === undefined 
        || data.length === 0) throw new Error('ë°ì´í„°ê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.')
      if(!(Array.isArray(data))) throw new Error('ë°ì´í„° íƒ€ì…ì´ Arrayê°€ ì•„ë‹™ë‹ˆë‹¤.')
    }

    function checkItem(item){
      const {text, isCompleted} = item;
      if(text === undefined || text === null 
        || isCompleted === undefined || isCompleted === null) throw new Error('ë°ì´í„°ê°€ ì…ë ¥ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.')
      if(typeof text !== 'string' || 
        typeof isCompleted !== 'boolean') throw new Error('ë°ì´í„° í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.')
      if(text === '') throw new Error('íˆ¬ë‘ë¥¼ ì…ë ¥í•˜ì„¸ìš”!')
    }

    this.setState = function (nextData){
      setTimeout(() => {
        checkData(nextData);
        this.data = [...data, ...nextData];
        this.render();
      }, 2000);
    }

    function makeHTML(item){
      checkItem(item);
      if(item.isCompleted) return `<li>âœ… <s><i>${item.text}</i></s></li>`
      return `<li>ğŸ”œ ${item.text} </li>`
    }

    this.render = function (){
      const todoList = document.getElementById(id);

      const todos = this.data.map(item => makeHTML(item)).join('');
      const idToTitle = id.toUpperCase()
      todoList.innerHTML = `<h3>ğŸ“${idToTitle}</h3> ${todos}`;
    }
  }

  const todoList = new TodoList(data, 'todo-list-1');
  const todoList2 = new TodoList(data2, 'todo-list-2');
  const todoList3 =  new TodoList(data3, 'todo-list-3');

  const Lists = [todoList, todoList2, todoList3];
  Lists.forEach(list => list.render());
  
  todoList2.setState([
    {
      text: 'ìƒˆë¡œìš´ íˆ¬ë‘ ì¶”ê°€ !!ğŸ‰',
      isCompleted: false,
    }
  ]);

  </script>
</body>
</html>
