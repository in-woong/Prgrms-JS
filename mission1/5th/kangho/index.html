<!DOCTYPE html>
<html>
    <head>
        <title>Mission 1_강호</title>
        <meta charset="utf-8">
    </head>
    <body>
        <div id="idTodoList"></div>

        <script>
            // new 키워드로 함수의 인스턴스를 만들 때 올바른 파라메터가 넘어오지 않을 경우 에러 발생하게 하기
            // new 키워드 안 붙이고 함수 실행 시 에러 발생하게 하기

            var data = [
                {text: 'JS Start'},
                {text: 'JS Study'},
                {text: 'JS Review'},
                {text: 'JS Ask'},
                {text: 'Yay!'},
                // {wrongTextName: 'dummy'},
                // {text: 222},
            ]
            
            function checkData(data) {
                if (!(data instanceof Array)) {
                    throw new Error('Error 2: not array');
                }

                if (data.length === 0) {
                    throw new Error('Error 3: empty array');
                }

                for (var i=0; i<data.length; i++) {
                    var keyNames = Object.keys(data[i]);
                    keyNames.forEach(function(names) {
                        if (names !== 'text') {
                            throw new Error('Error 4: wrong key name');
                        }
                    })
                }

                data.forEach(function(list) {
                    if(typeof list.text !== 'string') {
                        throw new Error('Error 5: not string type');
                    }
                })
            }

            function todoList(data) {
                if (!(this instanceof todoList)) {
                    throw new Error('Error 1: no new keyword');
                }
                checkData(data);
                this.data = data;
                this.render = function() {
                    idTodoList.innerHTML = this.data.reduce((htmlString, list) => htmlString + `<div> ${list.text} </div>`, '');
                }
                this.render();
            }

            // var todoList1 = todoList(data);
            var todoList2 = new todoList(data);

        </script>
    </body>
</html>