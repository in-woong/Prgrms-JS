<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <ul id="todo-list"></ul>
    <ul id="todo-list-2"></ul>
    <ul id="todo-list-3"></ul>

    <script>
      const data = [
        {
          text: 'JS ê³µë¶€í•˜ê¸°',
          isCompleted: true,
        },
        {
          text: 'JS ë³µìŠµí•˜ê¸°',
          isCompleted: false,
        },
      ];
      const data2 = [
        {
          text: 'HTML ê²¬ê³ í•˜ê²Œ ë§Œë“¤ê¸°ðŸ‘©â€ðŸ’»',
          isCompleted: false,
        },
      ];
      const data3 = [
        {
          text: 'CSS ìŠ¤íƒ€ì¼ë§ ðŸ’„',
          isCompleted: true,
        },
        {
          text: 'JS ì œëŒ€ë¡œ í•˜ê¸° ðŸŽ¯',
          isCompleted: false,
        },
      ];

      // ì´ê³³ì—ì„œ ì½”ë”©ì„ ì‹œìž‘í•˜ì„¸ìš”!
      class TodoList {
        constructor(data, selector) {
          validatedata(data);
          this.data = data;
          this.todoList = document.querySelector(selector);
        }

        render() {
          this.todoList.innerHTML = this.data
            .map(({ text, isCompleted }) =>
              isCompleted ? `<li><s>${text}</s></li>` : `<li>${text}</li>`
            )
            .join('');
        }

        setState(nextData) {
          validatedata(nextData);
          this.data = nextData;
          this.render();
        }
      }

      /**
       * TodoListì˜ dataê°’ì˜ ìœ íš¨ì„±ì„ ì²´í¬í•˜ëŠ” í•¨ìˆ˜ìž…ë‹ˆë‹¤.
       *
       * @param {Object[]} data - todo ê°ì²´
       * @param {string} data[].text - í•  ì¼ì— ëŒ€í•œ ë‚´ìš©
       * @param {string} data[].isCompleted - í•  ì¼ ì™„ë£Œì—¬ë¶€
       */
      const validatedata = (data) => {
        if (!data) {
          throw new Error('TodoListë¥¼ ìƒì„±í•  ë•Œ dataëŠ” í•„ìˆ˜ê°’ìž…ë‹ˆë‹¤.');
        }

        if (!Array.isArray(data)) {
          throw new Error('dataëŠ” array íƒ€ìž…ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
        }

        for (const todo of data) {
          if (!('text' in todo) || !('isCompleted' in todo)) {
            throw new Error('ë°ì´í„°ì˜ í˜•ì‹ì„ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”.');
          }
        }
      };

      window.addEventListener('DOMContentLoaded', () => {
        const todoList = new TodoList(data, '#todo-list');
        todoList.render();
        todoList.setState(data3);

        const todoList2 = new TodoList(data2, '#todo-list-2');
        todoList2.render();

        const todoList3 = new TodoList(data3, '#todo-list-3');
        todoList3.render();
        todoList3.setState(data);
      });
    </script>
  </body>
</html>
