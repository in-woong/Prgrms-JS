<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list"></div>
    <div id="todo-list-weekly"></div>
    <div id="todo-list-monthly"></div>
    <script>
      var data = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: false,
        },
      ];

      var dataWeekly = [
        {
          text: '방청소',
          isCompleted: true,
        },
        {
          text: '운동',
          isCompleted: false,
        },
      ];

      var dataMonthly = [
        {
          text: 'TS 공부하기',
          isCompleted: false,
        },
        {
          text: 'React 복습하기',
          isCompleted: true,
        },
      ];

      var newData = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: true,
        },
        {
          text: '스터디 미션1',
          isCompleted: false,
        },
        {
          text: '스터디미션2',
          isCompleted: false,
        },
      ];

      class TodoList {
        constructor(listId, data) {
          this.$list = document.querySelector(`#${listId}`);
          this.validate(data);
          this.data = data;
        }

        validate(data) {
          if (!data) {
            throw new Error('data does not exist');
            return;
          } else if (!Array.isArray(data)) {
            throw new Error('data must be array');
            return;
          } else if (
            !data.every(
              (todo) => todo instanceof Object && todo.hasOwnProperty('text')
            )
          ) {
            throw new Error('data is invalid');
            return;
          }
        }

        render() {
          this.data.forEach((todo) => {
            const $todo = document.createElement('div');
            $todo.innerHTML = todo.isCompleted
              ? `<s>${todo.text}</s>`
              : todo.text;
            this.$list.appendChild($todo);
          });
        }

        setState(nextData) {
          this.validate(nextData);
          this.data = nextData;
          this.$list.innerHTML = null;
          this.render();
        }
      }

      const todoList = new TodoList('todo-list', data);
      todoList.render();

      const todoListWeekly = new TodoList('todo-list-weekly', dataWeekly);
      todoListWeekly.render();

      const todoListMonthly = new TodoList('todo-list-monthly', dataMonthly);
      todoListMonthly.render();

      todoList.setState(newData);
    </script>
  </body>
</html>
