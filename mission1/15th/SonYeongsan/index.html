<html>

<head>
  <title>Mission 1</title>
  <meta charset="utf-8" />
</head>

<body>
  <div id="component-1"></div>
  <div id="component-2"></div>
  <div id="component-3"></div>
  <script>
    const $selector = ($target) => document.querySelector($target);
    const $creator = ($target) => document.createElement($target);

    const ERROR_MESSAGE = {
      CONSTRUCTOR: 'new 키워드를 사용해 생성자 함수로 호출해 주세요.',
      TYPE: '유효한 입력값이 아닙니다. 입력값은 배열 형태만 가능합니다.',
      CONTENT: '텍스트 컨텐츠가 존재하지 않거나 유효하지 않습니다. 텍스트 컨텐츠를 확인해 주세요.',
      FALSY: '입력한 값이 없습니다. 입력한 값이 있는지 확인해 주세요.',
      TARGET: '컴포넌트 요소가 존재하지 않습니다.'
    }

    const study = [
      {
        text: 'JS 공부하기',
        isCompleted: true,
      },
      {
        text: 'JS 복습하기',
        isCompleted: true,
      },
    ]
    const work = [
      {
        text: '기존 프로젝트 유지보수',
        isCompleted: false
      },
      {
        text: '신규 프로젝트 진행',
        isCompleted: true,
      }
    ]
    const hobby = [
      {
        text: '풋살 레슨 참가',
        isCompleted: true,
      },
      {
        text: '런데이 러닝 대회 참가',
        isCompleted: false
      }
    ]

    function TodoList(todos, $target) {

      const validateData = (data, target) => {
        const invalidContent = data.every(({ text }) => !!text);
        if (!new.target) throw new Error(ERROR_MESSAGE.CONSTRUCTOR);
        if (!data || !data.length) throw new Error(ERROR_MESSAGE.FALSY);
        if (!Array.isArray(data)) throw new Error(ERROR_MESSAGE.TYPE);
        if (!invalidContent) throw new Error(ERROR_MESSAGE.CONTENT);
        if (!target) throw new Error(ERROR_MESSAGE.TARGET);
      }

      validateData(todos, $target);

      this.todos = todos;

      this.setState = (newTodos) => {
        this.todos = newTodos;

        validateData(this.todos, $target);
        this.render();
      }

      this.render = () => {
        const $list = $creator('ul');
        $list.innerHTML = this.todos.map((todo) => this.makeTodo(todo)).join('');


        validateData(this.todos, $target);
        $selector($target).appendChild($list);
      }

      this.makeTodo = ({ text, isCompleted }) => isCompleted ? `<li><s>${text}</s></li>` : `<li>${text}</li>`
    }

    const studyTodoList = new TodoList(study, '#component-1');
    const workTodoList = new TodoList(work, '#component-2');
    const hobbyTodoList = new TodoList(hobby, '#component-3');

    studyTodoList.render();
    workTodoList.render();
    hobbyTodoList.render();

    studyTodoList.setState(work);
    studyTodoList.setState(hobby);
  </script>
</body>

</html>