<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list-1"></div>
    <div id="todo-list-2"></div>
    <div id="todo-list-3"></div>
    <script>
      const ERROR_MESSAGE = {
        NEW_KEYWORD: "You should use 'new' keyword when calling this function",
        DATA_TYPE: `Invalid data type in 'data' parameter. This should be array: `,
        DATA_CONTENT: `all items in 'data' parameter should have key 'text'`,
      };

      var data1 = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: true,
        },
      ];
      var data2 = [
        {
          text: '저녁 메뉴 정하기',
          isCompleted: false,
        },
        {
          text: '빨래하기',
          isCompleted: false,
        },
        {
          text: '1시간 운동하기',
          isCompleted: true,
        },
      ];
      var data3 = [
        {
          text: '코드리뷰하기',
          isCompleted: false,
        },
        {
          text: '포트폴리오 만들기',
          isCompleted: true,
        },
      ];
      // 이곳에서 코딩을 시작하세요!

      function TodoList($target, data) {
        if (this === window) {
          throw new Error(ERROR_MESSAGE.NEW_KEYWORD);
        }

        const validateData = (data) => {
          if (!Array.isArray(data)) {
            throw new Error(`${ERROR_MESSAGE.DATA_TYPE} ${data} `);
          }
          const hasText = data.every((item) => item.text !== undefined);

          if (!hasText || !data.length) {
            throw new Error(`${ERROR_MESSAGE.DATA_CONTENT}`);
          }
        };

        const $todoDiv = document.createElement('div');

        this.data = data;

        this.setState = (nextData) => {
          this.data = nextData;
          this.render();
        };

        this.render = () => {
          validateData(this.data);

          $todoDiv.innerHTML = `
          ${this.data
            .map((item) => {
              let { text, isCompleted } = item;
              return isCompleted
                ? `<div><s>${text}</s></div>`
                : `<div>${text}</div>`;
            })
            .join('')}
          `;
        };
        $target.appendChild($todoDiv);
      }

      const firstTodo = new TodoList(
        document.querySelector('#todo-list-1'),
        data1
      );
      const secondTodo = new TodoList(
        document.querySelector('#todo-list-2'),
        data2
      );
      const thirdTodo = new TodoList(
        document.querySelector('#todo-list-3'),
        data3
      );

      firstTodo.render();
      secondTodo.render();
      thirdTodo.render();

      secondTodo.setState(data1);
    </script>
  </body>
</html>
