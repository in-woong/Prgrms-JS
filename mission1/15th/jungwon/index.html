<html lang="ko">
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <ul id="todo-list"></ul>
    <ul id="todo-list-2"></ul>
    <ul id="todo-list-3"></ul>

    <script>
      const data = [
        {
          text: 'JS ê³µë¶€í•˜ê¸°',
          isCompleted: true,
        },
        {
          text: 'JS ë³µìŠµí•˜ê¸°',
          isCompleted: false,
        },
      ];
      const data2 = [
        {
          text: 'HTML ê²¬ê³ í•˜ê²Œ ë§Œë“¤ê¸°ğŸ‘©â€ğŸ’»',
          isCompleted: false,
        },
      ];
      const data3 = [
        {
          text: 'CSS ìŠ¤íƒ€ì¼ë§ ğŸ’„',
          isCompleted: true,
        },
        {
          text: 'JS ì œëŒ€ë¡œ í•˜ê¸° ğŸ¯',
          isCompleted: false,
        },
      ];

      class TodoList {
        constructor(data, selector) {
          this.data = data;
          this.$todoList = document.querySelector(selector);
        }

        /**
         * @param {Object[]} newData - í• ë‹¹í•  data
         * @param {string} newData[].text - í•  ì¼ì— ëŒ€í•œ ë‚´ìš©
         * @param {boolean} newData[].isCompleted - í•  ì¼ ì™„ë£Œì—¬ë¶€
         */
        set data(newData) {
          if (!newData) {
            throw new Error('TodoListë¥¼ ìƒì„±í•  ë•Œ dataëŠ” í•„ìˆ˜ê°’ì…ë‹ˆë‹¤.');
          }

          if (!Array.isArray(newData)) {
            throw new Error('dataëŠ” array íƒ€ì…ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
          }

          newData.forEach((todo) => {
            if (typeof todo !== 'object') {
              throw new Error('dataì˜ elementëŠ” objectíƒ€ì…ì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
              //
            } else if (Object.keys(todo).length === 0) {
              throw new Error('dataì˜ elementë¡œ ë¹ˆ ê°ì²´ë¥¼ í• ë‹¹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
            }

            if (!todo.text) {
              throw new Error('text í”„ë¡œí¼í‹°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');

              if (typeof todo.text !== 'string') {
                throw new Error('text í”„ë¡œí¼í‹°ì˜ typeì€ stringì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
              }
            }

            if (!('isCompleted' in todo)) {
              throw new Error('isCompleted í”„ë¡œí¼í‹°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');

              if (typeof todo.isCompleted !== 'boolean') {
                throw new Error(
                  'isCompleted í”„ë¡œí¼í‹°ì˜ typeì€ booleanì´ì—¬ì•¼ í•©ë‹ˆë‹¤.'
                );
              }
            }
          });

          this._data = newData;
        }

        /**
         * @return {Object[]} data - todo
         */
        get data() {
          return this._data;
        }

        /**
         * todoListë¥¼ ë Œë”í•˜ëŠ” ë©”ì†Œë“œì…ë‹ˆë‹¤.
         */
        render() {
          this.$todoList.innerHTML = this.data
            .map(({ text, isCompleted }) =>
              isCompleted ? `<li><s>${text}</s></li>` : `<li>${text}</li>`
            )
            .join('');
        }

        /**
         * ìƒˆë¡œìš´ ë°ì´í„°ì¸ nextDataë¥¼ ë°›ì•„ì„œ ë‹¤ì‹œ ë Œë”ë§í•˜ëŠ” ë©”ì†Œë“œì…ë‹ˆë‹¤.
         *
         * @param {Object[]} nextData
         * @param {string} nextData[].text - í•  ì¼ì— ëŒ€í•œ ë‚´ìš©
         * @param {boolean} nextData[].isCompleted - í•  ì¼ ì™„ë£Œì—¬ë¶€
         */
        setState(nextData) {
          this.data = nextData;
          this.render();
        }
      }

      const todoList = new TodoList(data, '#todo-list');
      todoList.render();
      todoList.setState(data3);

      const todoList2 = new TodoList(data2, '#todo-list-2');
      todoList2.render();

      const todoList3 = new TodoList(data3, '#todo-list-3');
      todoList3.render();
      todoList3.setState(data);
    </script>
  </body>
</html>
