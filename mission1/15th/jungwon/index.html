<html lang="ko">
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <ul id="todo-list"></ul>
    <ul id="todo-list-2"></ul>
    <ul id="todo-list-3"></ul>

    <script>
      const data = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: false,
        },
      ];
      const data2 = [
        {
          text: 'HTML 견고하게 만들기👩‍💻',
          isCompleted: false,
        },
      ];
      const data3 = [
        {
          text: 'CSS 스타일링 💄',
          isCompleted: true,
        },
        {
          text: 'JS 제대로 하기 🎯',
          isCompleted: false,
        },
      ];

      class TodoList {
        constructor(data, selector) {
          this.data = data;
          this.todoList = document.querySelector(selector);
        }

        /**
         * @param {Object[]} data - 할당할 data
         * @param {string} data[].text - 할 일에 대한 내용
         * @param {boolean} data[].isCompleted - 할 일 완료여부
         */
        set data(data) {
          if (!data) {
            throw new Error('TodoList를 생성할 때 data는 필수값입니다.');
          }

          if (!Array.isArray(data)) {
            throw new Error('data는 array 타입이여야 합니다.');
          }

          for (const todo of data) {
            if (!('text' in todo) || !('isCompleted' in todo)) {
              throw new Error('데이터의 형식을 다시 확인해주세요.');
            }

            if (typeof todo.text !== 'string') {
              throw new Error('text 프로퍼티의 type은 string이여야 합니다.');
            }

            if (typeof todo.isCompleted !== 'boolean') {
              throw new Error(
                'isCompleted 프로퍼티의 type은 boolean이여야 합니다.'
              );
            }
          }

          this._data = data;
        }

        /**
         * @return {Object[]} data - todo
         */
        get data() {
          return this._data;
        }

        /**
         * todoList를 렌더하는 메소드입니다.
         */
        render() {
          this.todoList.innerHTML = this.data
            .map(({ text, isCompleted }) =>
              isCompleted ? `<li><s>${text}</s></li>` : `<li>${text}</li>`
            )
            .join('');
        }

        /**
         * 새로운 데이터인 nextData를 받아서 다시 렌더링하는 메소드입니다.
         *
         * @param {Object[]} nextData
         * @param {string} nextData[].text - 할 일에 대한 내용
         * @param {boolean} nextData[].isCompleted - 할 일 완료여부
         */
        setState(nextData) {
          this.data = nextData;
          this.render();
        }
      }

      const todoList = new TodoList(data, '#todo-list');
      todoList.render();
      todoList.setState(data3);

      const todoList2 = new TodoList(data2, '#todo-list-2');
      todoList2.render();

      const todoList3 = new TodoList(data3, '#todo-list-3');
      todoList3.render();
      todoList3.setState(data);
    </script>
  </body>
</html>
