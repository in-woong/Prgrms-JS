<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list">
      <ul id="list-container"></ul>
    </div>
    <div id="proceeding-list">
      <ul id="list-container"></ul>
    </div>
    <div id="done-list">
      <ul id="list-container"></ul>
    </div>
    <script>
      var data = [
        {
          text: 'JS 공부하기',
          isCompleted: false,
        },
        {
          text: 'JS 복습하기',
          isCompleted: true,
        },
      ];

      var proceeding = [
        {
          text: 'mission1 보너스 구현사항',
          isCompleted: true,
        },
        {
          text: '다중 컴포넌트 만들기',
          isCompleted: false,
        },
      ];
      var done = [
        {
          text: 'mission1 필수 구현사항',
          isCompleted: false,
        },
        {
          text: '알고리즘 문제풀기',
          isCompleted: true,
        },
      ];
      // 이곳에서 코딩을 시작하세요!
      const $ = (selector) => document.querySelector(selector);

      //data 값이 text라는 프로퍼티를 가지고 있으면서
      // text의 타입이 string이어야 한다.
      //빈값도 막기
      const validation = (array) => {
        return array.filter(
          (item) =>
            item.hasOwnProperty('text') &&
            typeof item.text === 'string' &&
            item.text !== ''
        );
      };

      function TodoList(data, target) {
        if (!Array.isArray(data)) {
          throw new Error('error message');
        }

        this.list = validation(data);

        this.setState = (nextData) => {
          this.list = validation(nextData);

          this.render();
        };

        //완료된 리스트 삭선 긋기
        this.render = function () {
          //string으로 붙여야 하기에 join으로 배열을 합침
          const template = iscomplete();

          //ul과 ul의 id를 붙임
          // const ulElement = document.createElement('ul');
          // ulElement.setAttribute('id', 'ulElement');
          //해당 DOM을 넘겨서 재사용성 늘리기
          target.querySelector('#list-container').innerHTML = template;
        };

        const iscomplete = () => {
          const todoArr = this.list.map((item, idx) => {
            if (item.isCompleted) {
              return `<li id=${idx}><s>${item.text}</s></li>`;
            } else {
              return `<li id=${idx}>${item.text}</li>`;
            }
          });

          return todoArr.join('');
        };
      }

      const todoList = new TodoList(data, $('#todo-list'));
      const proceedingList = new TodoList(proceeding, $('#proceeding-list'));
      const doneList = new TodoList(done, $('#done-list'));

      todoList.render();
      proceedingList.render();
      doneList.render();
      // try {
      //   const todoList = TodoList(data);
      //   todoList.render();
      // } catch (error) {
      //   throw new Error('error message');
      // }

      todoList.setState([
        {
          text: 'JS 공부하기',
          isCompleted: false,
        },
        {
          text: 'JS 복습하기',
          isCompleted: true,
        },
        {
          text: 'setState 만들기',
          isCompleted: false,
        },
      ]);
    </script>
  </body>
</html>
