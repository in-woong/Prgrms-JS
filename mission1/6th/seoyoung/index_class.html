<html>

<head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
</head>

<body>
    <h1>클래스 버전</h1>
    <div id="todo-list"></div>
    <div id="today-todo-list"></div>
    <div id="yesterday-todo-list"></div>
    <script>
        let data = [{
                text: '코딩하기',
                isCompleted: true
            },
            {
                text: '집안 청소하기',
                isCompleted: false
            }
        ]
        let todayTodos = [{
                text: '스터디 과제하기',
                isCompleted: true
            },
            {
                text: '운동하기',
                isCompleted: true
            }
        ]
        let yesterdayTodos = [{
                text: '알고리즘 문제풀기',
                isCompleted: true
            },
            {
                text: '서류 쓰기',
                isCompleted: false
            }
        ]
        // 클래스버전
        class TodoList {
            constructor(data, queryId) {
                confirmData(data) && (this.todos = data)
                this.queryId = queryId
            }
            render() { // 추가 구현사항 - isCompleted 처리
                document.querySelector(this.queryId).innerHTML =
                    this.todos
                    .map(todo => todo.isCompleted ? `<div><s>${todo.text}</s></div>` : `<div>${todo.text}</div>`)
                    .join('\n')
            }
            setState(nextData) {
                this.todos = nextData
                this.render()
            }
        }

        // 추가 구현사항 - 보너스 구현사항 (에러 처리)
        function confirmData(data) {
            if (!data) {
                throw new Error('data가 없습니다')
            }
            if (!Array.isArray(data)) {
                throw new Error('배열 형태가 아닙니다')
            }
            if (data.some(data => typeof data.text !== 'string')) {
                throw new Error('내용이 이상한 데이터입니다')
            }
            return true
        }

        let todoList = new TodoList(data, '#todo-list');
        todoList.render();
        // 추가 구현사항 - 다중 컴포넌트
        let todayTodoList = new TodoList(todayTodos, '#today-todo-list');
        let yesterdayTodoList = new TodoList(yesterdayTodos, '#yesterday-todo-list');
        todayTodoList.render();
        yesterdayTodoList.render();
        // 추가 구현사항 - setState
        todoList.setState([{
            text: '새롭게 할 일',
            isCompleted: false
        }]);
    </script>
</body>

</html>