<html>

<head>
	<title>Mission 1</title>
	<meta charset="utf-8" />
</head>

<body>
<div id="todo-list"></div>
<div id="study-todo-list"></div>
<div id="work-todo-list"></div>
<script>
    let data = [
        {
            text: 'JS 공부하기',
            isCompleted: true

        },
        {
            text: 'JS 복습하기',
            isCompleted: false
        }
    ];

    let studyData = [
        {
            text: '변수 공부하기',
            isCompleted: true
        },
        {
            text: 'this 공부하기',
            isCompleted: true
        }
    ];

    let workData = [
        {
            text: '회의 준비하기',
            isCompleted: false
        },
        {
            text: '리팩토링 하기',
            isCompleted: false
        }
    ];

    function validator(data) {
        if (!data) {
            throw new Error('데이터를 입력해주세요!')
        }

        if (!(data instanceof Array)) {
            throw new Error('데이터의 형태가 배열이 아닙니다!');
        }

        data.forEach(item => {
            if (!item.text || typeof item.text !== 'string')
                throw new Error('데이터의 내용을 확인해주세요!');
        });

        return data;
    }

	function TodoList(data, targetId = 'todo-list') {
        if(!(this instanceof TodoList)) {
            throw new Error('new 키워드가 필요합니다!');
        }

		this.data = validator(data);

        this.render = function() {
            let todoHtml = '';

            this.data.map(todoItem => {
                todoHtml += `<li>${todoItem.isCompleted ? `<s>${todoItem.text}</s>` : todoItem.text}</li>`;
            });

			document.getElementById(`${targetId}`).innerHTML = `<ul>${todoHtml}</ul>`;
        };

        this.setState = function(nextData) {
            this.data = validator(nextData);
			this.render();
        }
    }

    try {
        const todoList = new TodoList(data);
        const studyTodoList = new TodoList(studyData, 'study-todo-list');
        const workTodoList = new TodoList(workData, 'work-todo-list');

        todoList.render();
        studyTodoList.render();
        workTodoList.render();

        todoList.setState([
	        {
	            text: 'ES6 공부하기'
	        },
            {
                text: 'ES6 복습하기'
            },
        ]);
    } catch(error) {
        console.log(error);
    }
</script>
</body>
</html>