<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list"></div>
    <div id="todo-list2"></div>
    <div id="todo-list3"></div>
    <script>
      // Data
      var data = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: false,
        },
      ]
      var data2 = [
        {
          text: 'JS 공부하기 2',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기 2',
          isCompleted: true,
        },
      ]
      var data3 = [
        {
          text: 'JS 공부하기 3',
          isCompleted: false,
        },
        {
          text: 'JS 복습하기 3',
          isCompleted: false,
        },
      ]

      // 이곳에서 코딩을 시작하세요!

      // Validation Util
      function validate(data, instanceThis) {
        function isValidDataContent(data) {
          if (data.length !== 0) {
            return data.every((todo) => {
              const { text } = todo
              return text
            })
          } else {
            return false
          }
        }

        let errorMessage = ''
        if (instanceThis === window) {
          // validate new operator
          errorMessage += ', new operator is required'
        } else if (data == null) {
          // validate null,undefined
          errorMessage += ', data is not defined'
        } else if (!Array.isArray(data)) {
          // validate array
          errorMessage += ', only array type data is permitted'
        } else if (!isValidDataContent(data)) {
          // validate data content
          errorMessage += ', data is not valid'
        }

        if (errorMessage) {
          throw new Error(errorMessage.substring(2))
        }
      }

      //Todo List

      // Constructor function 사용
      function TodoList(data, parentId) {
        validate(data, this)

        this.data = data
        this.render = () => {
          const todoList = document.querySelector(parentId)
          const todos = document.createElement('ul')
          todos.setAttribute('id', 'todos')
          let str = ''

          this.data.forEach((todo, i) => {
            console.log(todo)
            if (todo.isCompleted) {
              str += `<li><s>${todo.text}</s></li>`
            } else {
              str += `<li>${todo.text}</li>`
            }
          })
          todos.innerHTML = str
          todoList.append(todos)
        }
      }

      // // class 사용
      // class TodoListClass {
      //   constructor(data) {
      //     validate(data, this)
      //     this.data = data
      //   }

      //   render() {
      //     const todoList = document.querySelector('#todo-list')
      //     const todos = document.createElement('ul')
      //     todos.setAttribute('id', 'todos')
      //     let str = ''

      //     this.data.forEach((todo, i) => {
      //       str += `<li>${todo.text}</li>`
      //     })
      //     todos.innerHTML = str
      //     todoList.append(todos)
      //   }
      // }

      var todoList = new TodoList(data, '#todo-list')
      todoList.render()
      var todoList2 = new TodoList(data2, '#todo-list2')
      todoList2.render()
      var todoList3 = new TodoList(data3, '#todo-list3')
      todoList3.render()

      // var todoListClass = new TodoListClass(data)
      // todoListClass.render()
    </script>
  </body>
</html>
