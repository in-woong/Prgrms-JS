<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list-1"></div>
    <div id="todo-list-2"></div>
    <script>
      var data = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: true,
        },
      ]

      var data2 = [
        {
          text: 'TS 공부하기',
          isCompleted: true,
        },
        {
          text: 'TS 복습하기',
          isCompleted: false,
        },
      ]

      var dataChange = [
        {
          text: 'TS 공부하기',
          isCompleted: true,
        },
        {
          text: 'TS 복습하기',
          isCompleted: true,
        },
        {
          text: '출근 준비하기',
          isCompleted: false,
        },
      ]
      // 이곳에서 코딩을 시작하세요!
      const checkDataType = (data) => {
        for (let item in data) {
          if (
            typeof data[item] == null ||
            typeof data[item] == undefined ||
            (typeof data[item] === 'object' && !Object.keys(data[item]).length)
          )
            return true
        }
        return false
      }

      const isCompletedCheck = (data) => {
        return data.isCompleted
          ? `<div><s>${data.text}</s></div>`
          : `<div>${data.text}</div>`
      }

      function TodoList(data, id) {
        this.data = data

        try {
          if (
            !Array.isArray(this.data) ||
            this.data === undefined ||
            !this.data
          ) {
            throw new Error('데이터 값은 배열이 아닌 값이 오면 안 됩니다.')
          }
          if (checkDataType(data)) {
            throw new Error('데이터 내용 값이 유효하지 않습니다.')
          }
          if (!(this instanceof TodoList)) {
            throw new Error('new를 사용하세요.')
          }
        } catch (error) {
          console.error(error)
          alert(error)
        }

        this.render = () => {
          let html =
            data &&
            data
              .map((value) => {
                return isCompletedCheck(value)
              })
              .join('')
          return (document.querySelector(`#${id}`).innerHTML = html)
        }

        this.setState = (nextData) => {
          data = nextData
          setTimeout(this.render, 1000)
        }
      }

      let todoList = new TodoList(data, 'todo-list-1')
      let todoList2 = new TodoList(data2, 'todo-list-2')
      todoList.render()
      todoList2.render()

      todoList2.setState(dataChange)
    </script>
  </body>
</html>
