<html>

<head>
  <title>Mission 1</title>
  <meta charset="utf-8" />
</head>

<body>
  <div id="todo-list"></div>
  <script>
    var data = [
      {
        text: 'JS 공부하기'
      },
      {
        text: 'JS 복습하기'
      },
      {
        text: 'JS 예습하기'
      }
    ];
	// 이곳에서 코딩을 시작하세요!
    // div 2개 더 만들기
    const div2 = document.createElement('div'); 
    div2.setAttribute('id', 'todo-list2');
    const div3 = document.createElement('div');
    div3.setAttribute('id', 'todo-list3');
    const scpt = document.querySelector('script');
    document.body.insertBefore(div2, scpt);
    document.body.insertBefore(div3, scpt);

    // array data 2개 더 만들기
    var data2 = [];
    var data3 = [];
    data2.push({text: '영어공부하기'}, {text: '중국어공부하기'}, {text: '일본어공부하기'});
    data3.push({text: '윗몸일으키기'}, {text: '팔굽혀펴기'}, {text: '게임하기'});
    
    // isCopleted 필드 추가하기
    for (let i=0; i<data.length; i++){
      if(i%2 === 0){
        data[i].isCompleted = true;
      } else {
        data[i].isCompleted = false;
      }
    }

    data2.forEach(function(item, i){
      if(i%2 === 0){
        item.isCompleted = true;
      } else {
        item.isCompleted = false;
      } 
    })

    for (let i=0; i<data3.length; i++){
      if (i%2 === 0){
        data3[i].isCompleted = false;
      } else {
        data3[i].isCompleted = true;
      }
    }

    // for (let i=0; i<data1.length; i++){
    //   if (i%2 === 0) {
    //     data1[i].push({isCompleted: true});
    //   } else {
    //     data1[i].push({isCompleted: false})
    //   }
    // }
    // for (let i=1; i<4; i++){
    //   for (let j=0; j<data[i].length; j++){
    //     if (j%2 == 0) {
    //       data[i][j].push({isCompleted: true})
    //     } else {
    //       data[i][j].push({isCompleted: false})
    //     }
    //   }
    // }
    

    // TodoList 함수 작성
    function TodoList(data){
      this.data = data;
      this.render = function () {
        // 피드백 받고 고침
        const targetToLi = document.querySelector('#todo-list');
        let jstxt = '';
        for (let i=0; i<data.length; i++){
        // isCompleted: true 인 것들 <s>로 삭신처리하기
          if (this.data[i].isCompleted === true){
            jstxt += `<ul><li><s>${this.data[i].text}</s></li></ul>` 
          } else {
            jstxt += `<ul><li>${this.data[i].text}</li></ul>`
          }
        }
        targetToLi.innerHTML = jstxt;  
        
      }
      // new 키워드 함수 인스턴트 만들때 올바른 파라미터 안 남어오면 에러 발생시키기
      if (data === null || data === undefined || !Array.isArray(data)) {
        throw new Error ('null or undefined or not Array')
      }
      // new 키워드 안 붙였을 경우 에러 발생시키기
      if (!(this instanceof TodoList)) {
        throw new Error('new로 생성 후 사용 바람');
      }
      
    }

    // 다중 컴포넌트 만들기
    function TodoList2(data2) {
      this.data2 = data2;
      this.render = function(){
        const targetToLi2 = document.querySelector('#todo-list2');
        // let languagetxt = '';
        for (let i=0; i<this.data2.length; i++){
          const list2 = document.createElement('li');
          // <s> 삭선처리하기
          if (this.data2[i].isCompleted === false){
            list2.innerHTML = `${this.data2[i].text}`;
          } else {
            list2.innerHTML = `<s>${this.data2[i].text}</s>`;
          }
          targetToLi2.appendChild(list2);
        }        
      }
      if(data2 === null || data2 === undefined || !Array.isArray(data2)) {
        throw new Error('null or undefined or not Array');
      }
      // constructor로 구현해봤는데 이해 안감
      if(this.constructor !== TodoList2) {
        throw new Error('new를 써서 하라고')
      }
    }

    function TodoList3(data3) {
      this.data3 = data3;
      this.render = function() {
        document.querySelector('#todo-list3').innerHTML = this.data3.map(function(x, i) {
          // <s> 삭선처리
          if (this.data3[i].isCompleted === true) {
            return `<span><s>${x.text}</s></span>`
          } else {
            return `<span>${x.text}</span>`
          }
        }).join('');
      }
      if (data3 === null || data3 === undefined || !Array.isArray(data3)) {
        throw new Error('null or undefined or not Array');
      }
      // new.target으로 구현해봤는데 맞는거임?
      if (!new.target) {
        throw 'todoList3 must be called with new';
      }
    }

    // Instance 생성 및 함수 호출
    var todoList = new TodoList(data);
    var todoList2 = new TodoList2(data2);
    var todoList3 = new TodoList3(data3);

    todoList.render();
    todoList2.render();
    todoList3.render();

  </script>
</body>
</html>