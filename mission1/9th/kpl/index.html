<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list"></div>
    <div id="todo-list-food"></div>
    <div id="todo-list-travel"></div>
    <script>
      var data = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: false,
        },
      ]

      var dataFood = [
        {
          text: '돈까스 먹기',
          isCompleted: true,
        },
        {
          text: '커피 마시기',
          isCompleted: true,
        },
      ]

      var dataTravel = [
        {
          text: '제주도 가기',
          isCompleted: false,
        },
        {
          text: '우도 가기',
          isCompleted: false,
        },
      ]

      function TodoList(data, target) {
        if (new.target !== TodoList) {
          throw new Error('new 키워드로 함수의 인스턴스를 생성해야 합니다.')
        }

        validCheck(data, target)

        this.data = data
        this.target = target
        this.render = function () {
          let contents =
            '<ul>' +
            this.data
              .map((todo) => {
                return todo.isCompleted
                  ? `<li><s> ${todo.text} </s></li>`
                  : `<li> ${todo.text} </li>`
              })
              .join('') +
            '</ul>'

          document.querySelector(`#${target}`).innerHTML = contents
        }
        this.setState = function (nextData) {
          this.data = nextData
          this.render()
        }
      }

      // 데이터 밸리데이션 체크
      function validCheck(data, target) {
        // data가 없거나 Array 가 아닐경우
        if (!(data && data instanceof Array)) {
          throw new Error('올바른 데이터를 넘겨주세요.')
        }

        // target이 존재하지 않을 경우
        if (!(target && document.querySelector(`#${target}`))) {
          throw new Error('target이 존재하지 않습니다.')
        }
      }

      let todoList = new TodoList(data, 'todo-list')
      let todoListFood = new TodoList(dataFood, 'todo-list-food')
      let todoListTravel = new TodoList(dataTravel, 'todo-list-travel')

      todoList.setState(data)
    </script>
  </body>
</html>
