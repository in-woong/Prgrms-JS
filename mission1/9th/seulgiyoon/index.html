<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list-01"></div>
    <div id="todo-list-02"></div>
    <div id="todo-list-03"></div>
    <script>
      var data01 = [
        {
          text: 'JS 공부하기',
        },
        {
          text: 'JS 복습하기',
        },
      ]
      var data02 = [
        {
          text: '주말 장보기',
        },
        {
          text: '락스로 화장실 대청소',
        },
      ]
      var data03 = [
        {
          text: '블로그 작성하기',
        },
        {
          text: '업무일지 정리하기',
        },
      ]

      class TodoList {
        constructor(data, el) {
          // data가 안전한지 판단
          if (!this.checkDataError(data)) {
            throw new Error('데이터 형식이 잘못되었습니다.')
          }
          this.data = data
          this.el = document.getElementById(el)
          this.render()
        }

        checkDataError(data) {
          // data가 배열이 아닌 경우
          if (!Array.isArray(data)) {
            return false
          }
          // 배열이지만, 요소가 객체(배열, null이 아닌)인지 아닌지
          // 요소가 객체이지만 text라는 프로퍼티가 있는지 없는지
          // text라는 프로퍼티의 값이 문자열인지 아닌지 검사
          const isDataSafe = data.every(
            (item) =>
              typeof item === 'object' &&
              !Array.isArray(item) &&
              item !== null &&
              item.hasOwnProperty('text') &&
              typeof item.text === 'string'
          )
          return isDataSafe
        }

        render() {
          const todoListData = this.data.reduce((todoList, todo) => {
            return todoList + `<li>${todo.text}</li>`
          }, '<ul>')

          this.el.innerHTML = todoListData + '</ul>'
        }
      }

      const todoList01 = new TodoList(data01, 'todo-list-01')
      const todoList02 = new TodoList(data02, 'todo-list-02')
      const todoList03 = new TodoList(data03, 'todo-list-03')
    </script>
  </body>
</html>
