<html>

<head>
  <title>Mission 1</title>
  <meta charset="utf-8" />
</head>

<body>
  <div id="todo-list"></div>
  <div id="todo-list2"></div>
  <div id="todo-list3"></div>
  <script>
    const data = [
      {
        text: 'JS 공부하기',
        isCompleted:true
      },
      {
        text: 'JS 복습하기',
        isCompleted:false
      }
    ];

    const data2 = [
      {
        text: 'React 공부하기',
        isCompleted:true
      },
      {
        text: 'React 복습하기',
        isCompleted:true
      }
    ];

    const data3 = [
      {
        text: 'CS 공부하기',
        isCompleted:false
      },
      {
        text: 'CS 복습하기',
        isCompleted:false
      }
    ];
    
    class TodoList {

        static checkTypeOfData(data){
            if(!Array.isArray(data)){
                throw new Error('data is not array');
            }

            for(let i = 0; i < data.length; i+=1){
                if(!("text" in data[i])){
                    throw new Error(`data[${i}] has no text property`);
                }

                if(!("isCompleted" in data[i])){
                    throw new Error(`data[${i}] has no isCompleted property`);
                }

                if(typeof data[i].isCompleted !== "boolean"){
                    throw new Error(`data[${i}].isCompleted is not boolean`);
                }
            }
        }

        constructor(data,listId){
            TodoList.checkTypeOfData(data);
            this.data = data;
            this.$list = document.querySelector('#'+listId);
        }

        render(){
            this.$list.innerHTML = this.data.reduce((acc,datum)=>{
                let htmlString = datum.isCompleted ? `<s>${datum.text}</s>` : datum.text;
                return acc + `<div>${htmlString}</div>`;
            },'');
        }

        setState(nextData){
            TodoList.checkTypeOfData(nextData);
            this.data = nextData;
            this.render();
        }
    }

    const totalTodoList = [new TodoList(data,'todo-list'),new TodoList(data2,'todo-list2'),new TodoList(data3,'todo-list3')];
    totalTodoList.forEach((todoList)=>{
        todoList.render();
    });

    const nextData = [
        {
            text:'새로운 데이터입니다',
            isCompleted:false
        }
    ]

    totalTodoList[0].setState(nextData);

  </script>
</body>
</html>