<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list"></div>
    <div id="prev-todo-list"></div>
    <div id="essential-todo-list"></div>
    <script>
      const data = [
        { 
          text: '코딩하기',
          isCompleted: true
        },
        {
          text: '집안 청소하기',
          isCompleted: false
        }
      ]
      const prevTodoData = [
        {
          text: '프로그래머스 스터디 신청'
        },
        {
          text: '코어 자바스크립트 읽기'
        }
      ]
      const essentialTodoData = [
        {
          text: 'GitHub PR 요청'
        },
        {
          text: 'NextJS 공부하기'
        },
        {
          text: '리팩터링 2 읽기'
        }
      ]
      // 이곳에서 코딩을 시작하세요!
      class TodoList {
        constructor($target, data) {
          this.validate(data)
          this.data = data
          this.$target = $target
          this.render()
        }
        validate(data) {
          if (data === null || data === undefined)
            throw new Error('data가 null이거나 undefined 입니다.')
          if (!Array.isArray(data)) throw new Error('data가 배열이 아닙니다.')
          if (!data.every((v) => v.text && v.text.trim()))
            throw new Error('data의 내용(text)이 이상합니다.')
        }
        setState(nextData) {
          this.validate(nextData)
          this.data = nextData
          this.render()
        }
        render() {
          const template = `
            <ul>
              ${this.data.map(({ text, isCompleted = false }) => isCompleted ? `<li><s>${text}</s></li>` : `<li>${text}</li>`).join('')}  
            </ul>
          `
          this.$target.innerHTML = template
        }
      }

      const todoList = new TodoList(document.querySelector('#todo-list'), data)
      const prevTodoList = new TodoList(document.querySelector('#prev-todo-list'), prevTodoData)
      const essentialTodoList = new TodoList(document.querySelector('#essential-todo-list'), essentialTodoData)
      todoList.setState([{ text: '새로운 할 일', isCompleted: false }, { text: 'PR 등록하기', isCompleted: true }])
    </script>
  </body>
</html>
