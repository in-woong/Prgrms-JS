<html>

<head>
  <title>Mission 1</title>
  <meta charset="utf-8" />
</head>

<body>
  <div id="todo-list"></div>

  <!-- <div id="todo-list"></div> 외의 다른 div를 두 개 더 html 코드에 만듦 (보너스 구현사항 - 다중 컴포넌트 #57) -->
  <div id="my-todo-list__1"></div>
  <div id="my-todo-list__2"></div>
  <script>
    var data = [
      {
        text: 'JS 공부하기', 
        isCompleted: true
      },
      {
        text: 'JS 복습하기', 
        isCompleted: false
      }
    ];

    // var data = [{ ... }] 외에 todo를 담고 있는 array data를 두 개 더 만듦 (보너스 구현사항 - 다중 컴포넌트 #57)
    var myData1 = [
      {
        text: '드럼 연주하기',
        isCompleted: true, 
      },
      {
        text: '작곡하기', 
        isCompleted: true,
      }, 
      {
        text: '록 페스티벌 가기',
        isCompleted: false, 
      }
    ];

    var myData2 = [
      {
        text: '친구랑 밥 먹기',
        isCompleted: true, 
      }, 
      {
        text: 'HTML, CSS 공부하기',
        isCompleted: false,
      },
      {
        text: 'React 공부하기',
        isCompleted: false
      }
    ];

    var currentIdx = 0; 

  const TodoList = function(data) {
    // 에러 조건을 검사하는 함수 작성하기 (보너스 구현사항: #50)
    this.errorChecker = function() {
      if (this === window) throw new Error('please input "new" keyword if you want to create');
      if (data === ('' || null || undefined)) throw new Error('the data is empty');
      if (!Array.isArray(data)) throw new Error('the data is not an array!');
    }
    
    // 에러 처리를 위한 구문 (보너스 구현사항: #50)
    try {
      this.errorChecker();
    } catch (error) { 
      console.error(error);
      return;
    }

    // 에러가 나지 않았을 경우 프로퍼티와 메서드 작성하기 (TodoList 컴포넌트 작성하기: #49)
    this.data = data;
    // this.todoListComponent = document.querySelector('#todo-list');

    // 다중 컴포넌트를 구분해주기 위한 배열과 인덱스를 추가한 다음, 엘리먼트를 경우에 따라 선택하기 
    // (보너스 구현사항 - 다중 컴포넌트 #57)
    const todoListArray = ['#todo-list', '#my-todo-list__1', '#my-todo-list__2'];
    this.todoListComponent = document.querySelector(todoListArray[currentIdx]);
    currentIdx++;


    // 만약에 현재 데이터가 (보너스 구현사항 - 다중 컴포넌트 #57)
    this.render = function() {
      this.textToHTMLStringArray = [];
      this.data.forEach(obj => {
        const makeTextToString = obj.isCompleted ? `<s>${obj.text}</s>` : obj.text;
        this.textToHTMLStringArray.push(`<div>${makeTextToString}</div>`);
      });
      this.todoListComponent.innerHTML = this.textToHTMLStringArray.join('');
    }

    // TodoList 함수에 setState 함수를 만들기 (보너스 구현사항 - setState #67)
    this.setState = function(data) {
      this.data = data;
      this.todoListComponent.innerHTML = this.data.map(obj => `<div>${obj.text}</div>`).join('');
    }
  }


  // 코드를 직접 실행하기
  var todoList = new TodoList(data);
  todoList.render(); // todoList.render() 형태로 실행 (TodoList 컴포넌트 작성하기: #49)

  // 직접 만든 두 개의 컴포넌트를 실행 & 랜더링 (보너스 구현사항 - 다중 컴포넌트 #57)
  var myTodoList1 = new TodoList(myData1, true);
  var myTodoList2 = new TodoList(myData2, true);
  myTodoList1.render(); 
  myTodoList2.render(); 


  // setState가 정상적으로 동작되는지 확인할 수 있는 코드 (보너스 구현사항 - setState #67)
  // todoList.setState([{
  //   text: '놀기'
  // }]);
  </script>
</body>
</html>