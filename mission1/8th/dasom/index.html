<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list"></div>
    <div id="complete-list"></div>
    <div id="wish-list"></div>
    <div id="setState-list"></div>
    <script>
      const data = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: false,
        },
      ];

      const completeData = [
      {
          text: 'quiz 풀기',
          isCompleted: true,
        },
        {
          text: 'quiz 해설 복습하기',
          isCompleted: true,
        },
      ];

      const wishData = [
      {
          text: '파천갑주 얻기',
          isCompleted: false,
        },
        {
          text: '파천비곤얻기',
          isCompleted: false,
        },
      ];

      const inCorrectData = [
        {
          text: '올바르지 않은 데이터'
        }
      ];

      // 이곳에서 코딩을 시작하세요!

      function TodoList(param, id){
        this.data = param;
        this.render = function(){
          try{
            this.isValid();
            document.querySelector('#'+id).innerHTML = this.data.map(d=>{
                return d.isCompleted ? `<div><s>${d.text}</s></div>`: `<div>${d.text}</div>`}).join(' ');
          } catch(e){
            console.log(e);
          }
        },
        this.isValid = function(){
          if(param === null || param === undefined){
            throw new Error('param이 null 혹은 undefinded입니다.');
          }
          if(!Array.isArray(param)){
            throw new Error('param이 array형태가 아닙니다.');
          }
          if(!param.every(p=>{return p.text!=undefined && p.isCompleted!=undefined})){
            throw new Error('param의 data 형태가 잘못됐습니다.');
          }
          // if(new.target){
          //   console.log('new target');
          // } else {
          //   throw new Error('new 키워드를 붙여주세요.');
          // }
        },
        this.setState = function(newParam){
          this.data = newParam;
          this.render();
        }
      };

      const todoList = new TodoList(data, 'todo-list').render();
      const completeList = new TodoList(completeData, 'complete-list').render();
      const wishList = new TodoList(wishData, 'wish-list').render();

      // todoList.render();
      // completeList.render();
      // wishList.render();
      
      let nullList = new TodoList().render();
      // nullList.render();

      let notArray = new TodoList({
          text: 'JS 공부하기',
          isCompleted: true,
        }, 'todo-list').render();
      // notArray.render();

      // data가 text나 isCompleted를 가지고있지 않으면 잘못된 데이터 형태
      let inCorrectDataType = new TodoList(inCorrectData, 'todo-list').render();
      // inCorrectDataType.render();

      let notNew = TodoList(data, 'todo-list')
     // notNew.render();


      let setStateList = new TodoList(data, 'setState-list');
      setStateList.setState(completeData, 'setState-list');
    </script>
  </body>
</html>
