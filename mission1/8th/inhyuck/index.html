<!DOCTYPE html>
<html lang="ko">

<head>
	<title>Mission 1</title>
	<meta charset="utf-8"/>
</head>

<body>
<div id="todo-list"></div>
<div id="developer-todo-list"></div>
<div id="happy-life-todo-list"></div>

<script>
	const data = [
		{
			text: 'JS 공부하기',
			isCompleted: false,
		},
		{
			text: 'JS 복습하기',
			isCompleted: true,
		},
	];

	const developerTodoItems = [
		{
			text: 'JS 스터디 열심히 참여하며 배운내용 잘 정리',
			isCompleted: true,
		},
		{
			text: '사이드 프로젝트 개선',
			isCompleted: false,
		},
	];

	const happyLifeTodoItems = [
		{
			text: '책 읽고 간단히라도 글 쓰기',
			isCompleted: true,
		},
		{
			text: '규칙적인 아침 기상',
			isCompleted: false,
		},
		{
			text: '조급해하지 않기',
			isCompleted: true,
		},
	];

	function TodoList({todoItems, targetElementId}) {
		if (!(this instanceof TodoList)) { //new 키워드로 호출하지 않은 경우
			errorHandler();
		}
		if (!validateTodoItems({todoItems})) {
			errorHandler();
		}

		this.todoItems = todoItems;
		this.render = function () {
			const $todoList = document.getElementById(targetElementId);
			$todoList.innerHTML = this.todoItems.map(todoItem => convertTodoItemToInnerHtml({todoItem})).join('');
		};
	}

	function convertTodoItemToInnerHtml({todoItem}) {
		const {text, isCompleted} = todoItem;
		return `
			<div>
				${isCompleted ? '<s>' : ''}
					${text}
				${isCompleted ? '</s>' : ''}
			</div>
		`;
	}

	function validateTodoItems({todoItems}) {
		if (!todoItems) { //null or undefined
			return false;
		}

		if (!Array.isArray(todoItems)) { //not array
			return false;
		}

		if (todoItems.some(todoItem => !todoItem['text'])) {
			//text 키를 갖고있지 않거나 text 값이 falsy 인 경우
			return false;
		}

		return true;
	}

	function errorHandler() {
		throw new Error('error message');
	}

	const todoList = new TodoList({todoItems: data, targetElementId: 'todo-list'});
	todoList.render();

	const developerTodoList = new TodoList({todoItems: developerTodoItems, targetElementId: 'developer-todo-list'});
	developerTodoList.render();

	const happyLifeTodoList = new TodoList({todoItems: happyLifeTodoItems, targetElementId: 'happy-life-todo-list'});
	happyLifeTodoList.render();

</script>
</body>
</html>
