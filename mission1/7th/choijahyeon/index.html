<html>

<head>
  <title>Mission 1</title>
  <meta charset="utf-8" />
</head>

<body>
  <div id="todo-list-today"></div>
  <div id="todo-list-anytime"></div>
  <div id="todo-list-someday"></div>
  <script>
    const data = {
      today : [
        {
          text: 'JS 공부하기',
          isCompleted: true
        },
        {
          text: 'JS 복습하기',
          isCompleted: false
        }
      ],
      anytime: [
        { 
          text: '방 청소하기',
          isCompleted: true
        },
        {
          text: '자전거 타기',
          isCompleted: false
        } 
      ],
      someday : [
        {
          text: '유럽 여행',
          isCompleted: false
        },
        {
          text: '운전 연수',
          isCompleted: false
        }
      ]
    };
    const types = ['today', 'anytime', 'someday'];

    function TodoList(data, type) {
      if(!new.target) {
        throw new Error('[error] TodoList() must be called with new.');
      }
      if(!Array.isArray(data)) {
        throw new Error('[error] parameter is not array.');
      }
      this.todos = data;
      this.render = function() {
          const lis = this.todos.map((todo) => {
            if( !todo.text || typeof todo.text !== 'string' || typeof todo.isCompleted !== 'boolean') {
              throw new Error(`[error][${type}] todo list type Error.`);
            } 
            return todo.isCompleted ? `<li><s>${todo.text}</s></li>` : `<li>${todo.text}</li>`;
          }).join('');
          document.querySelector(`#todo-list-${type}`).innerHTML = `<ul>${lis}<ul>`;
      },
      this.setState = function(nextData) {
        this.todos = nextData;
        this.render();
      }   
    }
    
    const todayTodoList = new TodoList(data['today'], 'today');
    const anytimeTodoList = new TodoList(data['anytime'], 'anytime');
    const somedayTodoList = new TodoList(data['someday'], 'someday');

    todayTodoList.render();
    anytimeTodoList.render();
    somedayTodoList.render();

    setTimeout(() => {
      todayTodoList.setState(data['today'].map((d) => {
        d.isCompleted = true;
        return d;
      }));
    }, 1000);
    
  </script>
</body>

</html>