<html>

<head>
  <title>Mission 1</title>
  <meta charset="utf-8" />
  <style>
    s {
      display: block;
    }
  </style>
</head>

<body>
  <h2>TODO</h2>
  <div id="todo-list"></div>

  <h2>Bucket-list</h2>
  <div id="bucket-list"></div>

  <h2>Todo-Later</h2>
  <div id="todo-later"></div>

  <script>
    var data = [
      {
        text: 'JS 공부하기',
        isCompleted: true
      },
      {
        text: 'JS 복습하기',
        isCompleted: false
      }
    ]

    const bucketListData = [
      {
        text: '운동 배우기',
        isCompleted: true
      },
      {
        text: '영어 공부하기',
        isCompleted: false
      }
    ]

    const todoLaterData = [
      {
        text: '산책하기',
        isCompleted: false
      },
      {
        text: '청소하기',
        isCompleted: false
      }
    ]
	
    function TodoList(targetId, todos) {
      this.data = todos
      this.id = targetId
      const todoElement = document.querySelector(this.id)

      // check validation
      if(!Array.isArray(this.data)) {
          throw new Error('data type error')
        }

      if(!this.id || !this.id.startsWith('#')) {
        throw new Error('Id type error')
      }

      this.render = function() {
        todoElement.innerHTML = this.data.map(list => {
          return `${list.text ? `${list.isCompleted ? `<s>${list.text}</s>` : `<div>${list.text}</div>`}` : ``}`
        }).join('')
      }

      this.setState = function(nextData) {
        this.data = nextData
        this.render()
      }

      this.render()
    }

    const todoList = new TodoList('#todo-list', data)
    const bucketList = new TodoList('#bucket-list', bucketListData)
    const todoLaterList = new TodoList('#todo-later', todoLaterData)

    const newData = [
      {
        text: '스터디 과제하기',
        isCompleted: false
      },
      {
        text: '엄마한테 전화하기',
        isCompleted: true
      }
    ]
    todoList.setState(newData)
  </script>
</body>
</html>
