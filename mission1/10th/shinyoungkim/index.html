<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list1"></div>
    <div id="todo-list2"></div>
    <div id="todo-list3"></div>

    <script>
      const data1 = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: false,
        },
      ]
      
      const data2 = [
        {
          text: 'HTML 공부하기',
          isCompleted: true,
        },
        {
          text: 'HTML 복습하기',
          isCompleted: false,
        },
      ]

      const data3 = [
        {
          text: 'CSS 공부하기',
          isCompleted: true,
        },
        {
          text: 'CSS 복습하기',
          isCompleted: false,
        },
      ]

      const data4 = [
        {
          text: 'set Data',
          isCompleted: true,
        },
        {
          text: 'set Data2',
          isCompleted: false,
        },
      ]

      function TodoList($targetEl, todoData) {
        
        this.$targetEl = document.querySelector($targetEl);
        this.todoData = todoData;

        if (!new.target) {
          throw Error ('Must be called with new');
        }
        
        if (!Array.isArray(todoData)) {
          throw Error ('Data have to be array');
        }

        if (!todoData) {
          throw Error ('Please Check your data');
        }


        this.render = function() {
          const stringHTML = this.todoData
          .map(({isCompleted, text}) => 
            isCompleted ? `<li><s>${text}</s></li>` : `<li>${text}</li>`
          )
          .join('');

          this.$targetEl.innerHTML = stringHTML;
        }

        this.setState = function(nextData) {
          this.todoData = nextData;
          this.render();
        }

        this.render();
      }

      try {
        const todoList1 = new TodoList('#todo-list1', data1);
        const todoList2 = new TodoList('#todo-list2', data2);
        const todoList3 = new TodoList('#todo-list3', data3);

        // todoList1.setState(data4);
        
        // setTimeout(() => {todoList1.setState(data4)}, 2000);

        todoList2.setState([
          ...todoList1.todoData,
          {
            text: 'set Test',
            isCompleted: true
          },
        ]);

      } catch (e) {
        console.error(e)
      }

    </script>
  </body>
</html>
