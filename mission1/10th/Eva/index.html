<html>
  <head>
    <title>Mission 1</title>
    <meta charset="utf-8" />
  </head>

  <body>
    <div id="todo-list"></div>
    <div id="wish-list"></div>
    <div id="shopping-list"></div>
    <script>
      const todoData = [
        {
          text: 'JS 공부하기',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기',
          isCompleted: false,
        },
      ]
      const wishData = [
        {
          text: '옷',
          isCompleted: true,
        },
        {
          text: '신발',
          isCompleted: false,
        },
      ]
      const shoppingData = [
        {
          text: '감자',
          isCompleted: true,
        },
        {
          text: '고구마',
          isCompleted: false,
        },
      ]
      const todoNextData = [
        {
          text: 'JS 공부하기2',
          isCompleted: true,
        },
        {
          text: 'JS 복습하기2',
          isCompleted: false,
        },
      ]

      function errorCheck(data, id) {
        if (!data) {
          throw new Error('data is null or undefined');
        } else if (!Array.isArray(data)){
          throw new Error('data is not an Array');
        } else {
          data.forEach(value => {
            if(!value.text) {
              throw new Error('data has not a Text');
            }
          })
        }

        if (!id) {
          throw new Error('Cannot find id');
        }
      }

      var TodoList = function(data, id) {
        var domId = document.getElementById(id);

        if (!(this instanceof TodoList)) {
          throw new Error('use the new keword to create a TodoList');
        } else {
          errorCheck(data, domId);
        }
        
        this.data = data;
        this.domId = domId;
        this.render = function() {
          var renderString = this.data.map(value => value.isCompleted === true ? value.text : `<s>${value.text}</s>`).join(' ');
          this.domId.innerHTML = renderString;
        }
        this.setState = function(nextData) {
          errorCheck(nextData, this.domId);
          this.data = nextData;
          this.render();
        }
      }

      var todoList = new TodoList(todoData, 'todo-list');
      var wishList = new TodoList(wishData, 'wish-list');
      var shoppingList = new TodoList(shoppingData, 'shopping-list');

      todoList.render();
      todoList.setState(todoNextData);
      wishList.render();
      shoppingList.render();
    </script>
  </body>
</html>
